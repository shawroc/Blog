# 引用类型

---
前言：最近在细读Javascript高级程序设计，对于我而言，中文版，书中很多地方一笔带过，所以用自己所理解的，尝试细致解读下。如有纰漏或错误，会非常感谢您的指出。文中绝大部分内容引用自《JavaScript高级程序设计第三版》。

---

引用类型的值（对象）是引用类型的一个实例对象。
在ECMAScript5中，引用类型是一种数据结构，用于将数据和功能组织在一起。它也常被称为类，但这种称呼并不妥当。

尽管ECMAScript从技术上讲是一门面向对象的语言，但它不具备传统的面向对象语言所支持的类和接口等基本结构。

引用类型有时候也被称为对象定义，因为它们描述的是一类对象所具有的属性和方法。

**对象是某个特定引用类型的实例。新对象是使用new操作符后跟一个构造函数来创建的。构造函数本身就是一个函数，只不过该函数是出于创建新对象的目的而定义的。**

```
// 例子, 通过构造函数创建一个对象
var person = new Object();
```

这行代码创建了Object引用类型的一个新实例对象，然后把该实例保存在了变量person中。

使用的构造函数是Object，它只为新对象定义了默认的属性和方法。

ECMASript提供了很多原生引用类型（例如Object），以便开发人员用以实现常见的计算任务。

## Object类型

到目前为止，我们看到大多数引用类型值都是Object类型的实例。
而且，Object也是ECMAScript中使用最多的一个类型。
虽然Object的实例对象不具备多少功能，但对于在应用程序中存储和传输数据而言，它们确实是非常理想的选择。

创建Object实例对象的方式有两种。

第一种是使用new操作符后跟Object构造函数；

```
var person = new Object();
person.name = "Shaw";
person.age = 18;
```

另一种方式是使用**对象字面量**表示法。对象字面量是对象定义的一种简写形式，目的在于简化创建包含大量属性的对象的过程。

```

//对象字面量语法

var person = {
    name: "Shaw",
    age: 18
}
```

语法详解：

用对象字面量创建对象，左边的花括号（{）表示对象字面量的开始，因为它出现在了表达式上下文(expression context)中。
ECMAScript中的表达式上下文，指的是该上下文期待一个值。 赋值操作符表示后面是一个值。

所以，左花括号在这里表示一个表达式的开始。

同样的花括号，如果出现在一个语句上下文（statement context）中，例如跟在if语句的后面，则表示一个语句块的开始。

然后，定义了name属性，之后是一个冒号，再后面是这个属性的值。

**在对象字面量中使用逗号来分隔不同的属性**，因此“Shaw”后面是一个逗号。

**但是，在age属性的值29的后面不能添加逗号，因为age是这个对象的最后一个属性。**

**在最后一个属性后面添加逗号，会在IE7及更早版本和Opera浏览器中导致错误。**

在使用对象字面量语法时，属性名也可以使用字符窜：

```
var person = {
    "name" : "Shaw",
    "age" : 18,
    5: true
}
```

这个例子会创建一个对象，包含三个属性： name、age和5。
**但这里的数值属性会自动转换为字符窜。**

**使用对象字面量语法时，如果空留其花括号，则可以定义只包含默认属性和方法的对象。**

```
var person = {}; // 等价于 var person = new Object();
person.name = "Shaw";
person.age = 18;
```

**在通过对象字面量定义对象时，实际上不会调用Object构造函数（Firefox2及更早版本会调用Object构造函数；但Firefox3之后就不会了）。**


虽然可以使用前面介绍的任何一种方法来定义对象，但开发人员更青睐对象字面量语法，因为字面量语法要求的代码量更少。

**对象字面量也是向函数传递大量可选参数的首选方式。**

```

function displayInfo(args) {
    var output = "";

    if(typeof args.name == "string") {
        output += "Name: " + args.name + "\n";
    }

    if(typeof args.age == "number") {
        output += "Age: " + args.age + "\n";
    }

    console.log(output);
}

displayInfo({
    name: "Shaw",
    age: 18
}); 
// "Name: Shaw 
// age: 18"

displayInfo({
    name: "Roc"
});
// "Name: Roc" 

```

在这个例子中，函数displayInfo()接受一个名为args的参数。
这个参数可能带哟偶一个名为name或age的属性，也可能这两个属性都有或者都没有。

在这个函数内部，我们通过typeof操作符来检测每个属性是否存在，然后再基于相应的属性来构建一条要显示的信息。

然后，我们调用了两次这个函数，每次都使用一个对象字面量来制定不同的数据。

这两次调用传递的参数虽然不同，但函数都能正常执行。

**这种传递参数的模式最适合需要向函数传入大量可选参数的情形。**

一般来讲，命名参数虽然容易处理，但在有多个可选参数的情况下就会显的不够灵活。
最好的做法是对那些必需值使用命名参数，而使用对象字面量来封装多个可选参数。

**一般来说，访问对象属性时使用的都是点表示法，这也是很多面向对象语言中通用的语法。** 

**不过，在JavaScript也可以使用方括号语法来访问对象的属性。在使用方括号语法时，应该将要访问的属性以字符窜的形式放在方括号中。**

```

var person = {
    name: "Shaw"
}

console.log(person["name"]); // "Shaw"
console.log(person.name); // "Shaw"

```

从功能上看，这两种访问对象属性的方法没有任何区别。
**但方括号语法的主要优点是可以通过变量来访问属性。**

```

var person = {
    name: "Shaw"
}

var propertyName = "name";

console.log(person[propertyName]); //"Shaw"
```

**如果属性名中包含会导致语法错误的字符，或者属性名使用的是关键字或保留字，也可以使用方括号表示法。**

```

person.first name; //肯定不行咯

person["first name"]; //这样是可以滴, 不过一般也不会这样写属性的。。。

```

由于“first name”中包含一个空格，所以不能使用点表示法来访问它。
然而，属性名中是可以包含非字母非数字的，这时候就可以使用方括号语法来访问它们。

**除非必须使用变量来访问属性，否则还是建议使用**点表示法**比较好**

