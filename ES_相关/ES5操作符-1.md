# 操作符

---
前言：最近在细读Javascript高级程序设计，对于我而言，中文版，书中很多地方一笔带过，所以用自己所理解的，尝试细致解读下。如有纰漏或错误，会非常感谢您的指出。文中绝大部分内容引用自《JavaScript高级程序设计第三版》。

---

ECMA-262描述一组用于**操作数据值**的操作符，包括算术操作符（如+和——）、位操作符、关系操作符和相等操作符。

ECMAScript操作符的与众不同之处在于，它们能够适用于很多值，例如：字符串、数字值、布尔值，甚至对象。

**在应用于对象时，相应的操作符通常都会调用对象的valueOf()和toString()方法，以便取得可以操作的值。**

## 一元操作符

只能操作一个值的操作符叫做一元操作符。

1. 递增和递减操作符

递增和递减操作符直接借鉴于C，而且各有两个版本：前置型和后置型。

顾名思义，前置型应该位于要操作的变量之前，而后置型应该位于要操作的变量之后。
因此，在使用前置递增操作符给一个数值加1时，要把两个加号（++）放在这个数值前面。

```
var age = 29;

++age;
```

在这个例子中，前置递增操作符把age的值变成了30（29加上1）。实际上，执行这个前置递增操作与执行以下操作的效果相同。

```
var age = 29;

age = age + 1;

```

执行前置递减的方法也类似，结果会从一个数值中减去1。使用前置递减操作符时，要把两个减号（--）放在相应变量的前面。

```
var age = 29;
--age;
```

这样，age变量的值就减少为28（从29中减去1）。

**执行前置递增和递减操作时，变量的值都是在语句被求值以前改变的。在计算机科学领域，这种情况通常被称为副效应。**

```
var age = 29;
var anotherAge = --age + 2;

console.log(age); //28
console.log(anotherAge); //30
```

变量anotherAge的初始值等于变量age的值前置递减之后加2。
由于先执行了减法操作，age的值变成了28，所以再加上2的结果就是30。

由于前置递增和递减操作与执行语句的优先级相等，因此这个整个语句会从左至右被求值。

```
var num1 = 2;
var num2 = 20;
var num3 = --num1 + num2; //21
var num4 = num1 + num2; //21
```

在这里，num3之所以等于21是因为num1先减去了1才与num2相加。
而变量num4也等于21是因为相应的加法操作使用了num1减去1之后的值。

后置型递增和递减操作符的语法不变，不过要放在变量的后面而不是前面。

后置递增和递减与前置递增和递减有一个非常重要的区别，即递增和递减操作是在包含它们的语句被求值之后才执行的。这个区别在某些情况下不是什么问题。

```
var age = 29;
age++;
```

把递增操作符放在变量后并不会改变语句的结果，因为递增是这条语句的唯一的操作。但是，当语句中还包含其他操作时，上述区别就很明显了。

```
var num1 = 2;
var num2 = 20;
var num3 = num1-- + num2; // num3为22
var num4 = num1 + num2; // num4 为21
```

仅仅将前置递减改成了后置递减，就立即看到差别。
差别的根源在于，这里在计算num3时使用了num1的原始值（2）完成了加法计算，而num4则是用哪个了递减后的值（1）。

**这4个一元操作符对任何值都适用，也就是它们不仅适用于整数，还可以用于字符串、布尔值、浮点数值和对象。**

在应用于不同的值时，递增和递减操作符遵循下列规则。

- 在应用于一个包含有效数字字符的字符串时，先将其转换为数字值，再执行加减1的操作。字符串变量变成数值变量。

- 在应用于一个不包含有效数字字符的字符串时，将变量的值设置为NaN。字符串变量变成数值变量。

- 在应用于布尔值false，先将其转换为0再执行减1的操作。布尔值变量变成数值变量。

- 在应用于布尔值true，先将其转换为1再执行减1的操作。布尔值变量变成数值变量。

- 在应用于浮点数值时，执行加减1的操作。

- 在应用于对象时，先调用对象的valueOf()方法以取得一个可供操作的值。然后对改制应用前述规则。如果结果是NaN，则在调用toString()方法后再应用前述规则。对象变量变成数值变量。

```
var s1 = "2";
var s2 = "z";

var b = false;
var f = 1.1;

var o = {};

var obj = {
    valueOf: function(){
        return -1;
    }
}

s1 ++; //3
s2 ++; //NaN

b ++; //1
f --; //0.1

o --; // NaN

obj ++; //0 

```

2. 一元加和减操作符

绝大多数开发人员对一元加和减操作符都不会陌生，而且这两个ECMAScript操作符的作用与数学书上将的完全一样。

一元加操作符以一个加号（+）表示，放在数值前面，对数值不会产生任何影响。

```
var num = 25;

num = +num; //25
```

不过，**在对非数值应用一元加操作符时，该操作符会像Number()转型函数一样对这个值执行转换。**
布尔值false和true将被转换为0和1，字符串值会被按照一组特殊的规则进行解析，而对象是先调用他们的valueOf()或toString()方法，再转换得到的值。

```

var s1 = "01";
var s2 = "1.1";
var s3 = "z";
var b = false;
var f = 1.1;
var o = {
    valueOf: function() {
        return -1;
    }
}

s1 = +s1; //1
s2 = +s2; //1.1
s3 = +s3; //NaN
b = +b; //0
f = +f; //1.1
o = +o; //-1
```

**一元减操作符主要用于表示负数，例如将1转换为-1。**

```
var num = 25;

num = -num;

console.log(num); // -25

```


在将一元减操作符应用于数值时，该值会变成负数。
而当应用于飞数值时，一元减操作符遵循与一元加操作符相同的规则，最后再将得到的数值转化为负数。

```
var s1 = "01";
var s2 = "1.1";
var s3 = "z";
var b = false;
var f = 1.1;
var o = {
    valueOf: function() {
        return -1;
    }
}

s1 = -s1; //-1
s2 = -s2; //-1.1
s3 = -s3; //NaN
b = -b; //0
f = -f; //-1.1
o = -o; //1
```

一元加和减操作符主要用于基本的算术运算，也可以像前面示例展示的一样用于转换数据类型。